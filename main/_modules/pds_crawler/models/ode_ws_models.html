
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pds_crawler.models.ode_ws_models &#8212; pds-crawler 0.1.dev1+ga4a9fb8 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/my-styles.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js"></script>
    <script src="../../../_static/js/mermaid.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><span><img src="../../../_static/logo.png"></span>
          pds-crawler library</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.dev1+ga4a9fb8</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/pdssp/pds_crawler">Git</a></li>
                <li><a href="../../../_static/report.html">Tests</a></li>
                <li><a href="../../../_static/coverage/index.html">Coverage</a></li>
                <li><a href="../../../glossary.html">Glossary</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Packages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../history.html">CHANGELOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction.html#purpose">Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction.html#context">Context</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../applicable_docs.html">Applicable and reference documents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../applicable_docs.html#applicable">Applicable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../applicable_docs.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Terms, definitions and abbreviated terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../conventions.html">Conventions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../conventions.html#use-case-diagram">Use case diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../conventions.html#class-diagram">Class diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../conventions.html#sequence-diagram">Sequence diagram</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../purpose.html">Purpose of the Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../external_view.html">External view of the software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../external_view.html#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../external_view.html#interfaces">Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations_environment.html">Operations environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../operations_environment.html#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operations_environment.html#hardware-configuration">Hardware configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operations_environment.html#software-configuration">Software configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operations_environment.html#operational-constraints">Operational constraints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations_basics.html">Operations basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../operations_basics.html#use-cases">Use cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operations_basics.html#operations">Operations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operation_manual.html">Operations manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#setup-and-initialisation">Set‐up and initialisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#mode-selection-and-control">Mode selection and control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#normal-operations">Normal operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#normal-termination">Normal termination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#error-conditions">Error conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operation_manual.html#recover-runs">Recover runs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference_manual.html">Reference manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference_manual.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference_manual.html#extraction">Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference_manual.html#transformation">Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference_manual.html#load">Load</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference_manual.html#models">Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial.html#python-api">Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorial.html#command-line">Command line</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Section <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: main
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
  </div>
</div>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <h1>Source code for pds_crawler.models.ode_ws_models</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># pds-crawler - ETL to index PDS data to pdssp</span>
<span class="c1"># Copyright (C) 2023 - CNES (Jean-Christophe Malapert for Pôle Surfaces Planétaires)</span>
<span class="c1"># This file is part of pds-crawler &lt;https://github.com/pdssp/pds_crawler&gt;</span>
<span class="c1"># SPDX-License-Identifier: LGPL-3.0-or-later</span>
<span class="sd">&quot;&quot;&quot;ODE services models</span>

<span class="sd">.. uml::</span>

<span class="sd">    class PdsRegistryModel {</span>
<span class="sd">        +ODEMetaDB: str</span>
<span class="sd">        +IHID: str</span>
<span class="sd">        +IHName: str</span>
<span class="sd">        +IID: str</span>
<span class="sd">        +IName: str</span>
<span class="sd">        +PT: str</span>
<span class="sd">        +PTName: str</span>
<span class="sd">        +DataSetId: str</span>
<span class="sd">        +NumberProducts: int</span>
<span class="sd">        +ValidTargets: Dict[str, List[str]]</span>
<span class="sd">        +MinOrbit: Optional[int]</span>
<span class="sd">        +MaxOrbit: Optional[int]</span>
<span class="sd">        +MinObservationTime: Optional[str]</span>
<span class="sd">        +MaxObservationTime: Optional[str]</span>
<span class="sd">        +NumberObservations: Optional[int]</span>
<span class="sd">        +SpecialValue1: Optional[str]</span>
<span class="sd">        +MinSpecialValue1: Optional[float]</span>
<span class="sd">        +MaxSpecialValue1: Optional[float]</span>
<span class="sd">        +SpecialValue2: Optional[str]</span>
<span class="sd">        +MinSpecialValue2: Optional[float]</span>
<span class="sd">        +MaxSpecialValue2: Optional[float]</span>
<span class="sd">    }</span>

<span class="sd">    class PdsRecordModel {</span>
<span class="sd">        +ode_id: str</span>
<span class="sd">        +pdsid: str</span>
<span class="sd">        +ihid: str</span>
<span class="sd">        +iid: str</span>
<span class="sd">        +pt: str</span>
<span class="sd">        +LabelFileName: str</span>
<span class="sd">        +Product_creation_time: str</span>
<span class="sd">        +Target_name: str</span>
<span class="sd">        +Data_Set_Id: str</span>
<span class="sd">        +Easternmost_longitude: float</span>
<span class="sd">        +Maximum_latitude: float</span>
<span class="sd">        +Minimum_latitude: float</span>
<span class="sd">        +Westernmost_longitude: float</span>
<span class="sd">        +Product_version_id: Optional[str]</span>
<span class="sd">        +RelativePathtoVol: Optional[str]</span>
<span class="sd">        +label: Optional[str]</span>
<span class="sd">        +PDS4LabelURL: Optional[str]</span>
<span class="sd">        +PDSVolume_Id: Optional[str]</span>
<span class="sd">        +Label_product_type: Optional[str]</span>
<span class="sd">        +Observation_id: Optional[str]</span>
<span class="sd">        +Observation_number: Optional[int]</span>
<span class="sd">        +Observation_type: Optional[str]</span>
<span class="sd">        +Producer_id: Optional[str]</span>
<span class="sd">        +Product_name: Optional[str]</span>
<span class="sd">        +Product_release_date: Optional[str]</span>
<span class="sd">        +Activity_id: Optional[str]</span>
<span class="sd">        +Predicted_dust_opacity: Optional[float]</span>
<span class="sd">        +Predicted_dust_opacity_text: Optional[str]</span>
<span class="sd">        +Observation_time: Optional[str]</span>
<span class="sd">        +SpaceCraft_clock_start_count: Optional[str]</span>
<span class="sd">        +SpaceCraft_clock_stop_count: Optional[str]</span>
<span class="sd">        +Start_orbit_number: Optional[int]</span>
<span class="sd">        +Stop_orbit_number: Optional[int]</span>
<span class="sd">        +UTC_start_time: Optional[str]</span>
<span class="sd">        +UTC_stop_time: Optional[str]</span>
<span class="sd">        +Emission_angle: Optional[float]</span>
<span class="sd">    }</span>

<span class="sd">    class ProductFile {</span>
<span class="sd">        +FileName: str</span>
<span class="sd">        +Type: Optional[str]</span>
<span class="sd">        +KBytes: Optional[float]</span>
<span class="sd">        +URL: Optional[str]</span>
<span class="sd">        +Description: Optional[str]</span>
<span class="sd">        +Creation_date: Optional[str]</span>
<span class="sd">    }</span>

<span class="sd">    PdsRecordModel --&gt; ProductFile</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">field</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">cast</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterator</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pystac</span>
<span class="kn">from</span> <span class="nn">shapely</span> <span class="kn">import</span> <span class="n">geometry</span>
<span class="kn">from</span> <span class="nn">shapely</span> <span class="kn">import</span> <span class="n">wkt</span>

<span class="kn">from</span> <span class="nn">..exception</span> <span class="kn">import</span> <span class="n">CrawlerError</span>
<span class="kn">from</span> <span class="nn">..exception</span> <span class="kn">import</span> <span class="n">DateConversionError</span>
<span class="kn">from</span> <span class="nn">..exception</span> <span class="kn">import</span> <span class="n">PdsCollectionAttributeError</span>
<span class="kn">from</span> <span class="nn">..exception</span> <span class="kn">import</span> <span class="n">PdsRecordAttributeError</span>
<span class="kn">from</span> <span class="nn">..exception</span> <span class="kn">import</span> <span class="n">PlanetNotFound</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">ProgressLogger</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">utc_to_iso</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">UtilsMath</span>
<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">AbstractModel</span>
<span class="kn">from</span> <span class="nn">.pds_models</span> <span class="kn">import</span> <span class="n">Labo</span>
<span class="kn">from</span> <span class="nn">.pdssp_models</span> <span class="kn">import</span> <span class="n">PdsspModel</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="ProductFile"><a class="viewcode-back" href="../../../reference_manual.html#pds_crawler.models.ode_ws_models.ProductFile">[docs]</a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ProductFile</span><span class="p">(</span><span class="n">AbstractModel</span><span class="p">):</span>
    <span class="n">FileName</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">Type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">KBytes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">URL</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Creation_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">UtilsMath</span><span class="o">.</span><span class="n">convert_dt</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">env</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters</span>
            <span class="p">}</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PdsRegistryModel"><a class="viewcode-back" href="../../../reference_manual.html#pds_crawler.models.ode_ws_models.PdsRegistryModel">[docs]</a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">PdsRegistryModel</span><span class="p">(</span><span class="n">AbstractModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ODE present products on an instrument host id, instrument id,</span>
<span class="sd">    and product type structure.</span>

<span class="sd">    see : https://oderest.rsl.wustl.edu/ODE_REST_V2.1.pdf</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ODEMetaDB</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;ODE Meta DB – can be used as a Target input&quot;&quot;&quot;</span>
    <span class="n">IHID</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Instrument Host Id&quot;&quot;&quot;</span>
    <span class="n">IHName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Instrument Host Name&quot;&quot;&quot;</span>
    <span class="n">IID</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Instrument Id&quot;&quot;&quot;</span>
    <span class="n">IName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Instrument Name&quot;&quot;&quot;</span>
    <span class="n">PT</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Product Type&quot;&quot;&quot;</span>
    <span class="n">PTName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Product Type Name&quot;&quot;&quot;</span>
    <span class="n">DataSetId</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Data Set Id&quot;&quot;&quot;</span>
    <span class="n">NumberProducts</span><span class="p">:</span> <span class="nb">int</span>
    <span class="sd">&quot;&quot;&quot;Number of products with this instrument host/instrument/product type&quot;&quot;&quot;</span>
    <span class="n">ValidTargets</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Set of valid target values for the Target query parameter for a given</span>
<span class="sd">    instrument host, instrument, product type. IIPTs are usually</span>
<span class="sd">    targeted to the primary body for that ODE meta database. Example,</span>
<span class="sd">    the products in the ODE Mars meta database primarily target Mars.</span>
<span class="sd">    But some IIPTs have additional targets such as DIEMOS,</span>
<span class="sd">    PHOBOS, or special calibration targets. These targets can then be</span>
<span class="sd">    used in the query parameter TARGET=.&quot;&quot;&quot;</span>
    <span class="n">MinOrbit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Minimum orbit value for all products with this instrument</span>
<span class="sd">    host/instrument/product type&quot;&quot;&quot;</span>
    <span class="n">MaxOrbit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Maximum orbit value for all products with this instrument</span>
<span class="sd">    host/instrument/product type&quot;&quot;&quot;</span>
    <span class="n">MinObservationTime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Minimum observation time value for all products with this</span>
<span class="sd">    instrument host/instrument/product type&quot;&quot;&quot;</span>
    <span class="n">MaxObservationTime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Maximum observation time value for all products with this</span>
<span class="sd">    instrument host/instrument/product type&quot;&quot;&quot;</span>
    <span class="n">NumberObservations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Number of observation values found in the products (valid only for</span>
<span class="sd">    selected instrument host/instrument/product types such as LOLA)&quot;&quot;&quot;</span>
    <span class="n">SpecialValue1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Some sets have special values unique to that set. This is the name</span>
<span class="sd">    or description of that value. Special values capture product type</span>
<span class="sd">    specific information. For example, LRO LOLA RDRs include a</span>
<span class="sd">    special value that holds the range of altimetry data. &quot;&quot;&quot;</span>
    <span class="n">MinSpecialValue1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Minimum special value 1&quot;&quot;&quot;</span>
    <span class="n">MaxSpecialValue1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Maximum special value 1&quot;&quot;&quot;</span>
    <span class="n">SpecialValue2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Some sets have a second special values unique to that set. This is</span>
<span class="sd">    the name or description of that value.&quot;&quot;&quot;</span>
    <span class="n">MinSpecialValue2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Minimum special value 2&quot;&quot;&quot;</span>
    <span class="n">MaxSpecialValue2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Maximum special value 2&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_collection_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_collection_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_collection</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataSetId</span>

    <span class="k">def</span> <span class="nf">get_instrument_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_instru_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">IID</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">IName</span>

    <span class="k">def</span> <span class="nf">get_plateform_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_platform_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">IHID</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_plateform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">IHName</span>

    <span class="k">def</span> <span class="nf">get_mission_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_mission_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">IHID</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_mission</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">IHName</span>

    <span class="k">def</span> <span class="nf">get_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ODEMetaDB</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ODEMetaDB</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">body</span>

    <span class="k">def</span> <span class="nf">get_body_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_body_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_body</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_range_orbit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]:</span>
        <span class="nb">range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MinOrbit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxOrbit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">(</span>
                <span class="n">minimum</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MinOrbit</span><span class="p">),</span> <span class="n">maximum</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MaxOrbit</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">range</span>

    <span class="k">def</span> <span class="nf">get_range_special_value1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]:</span>
        <span class="nb">range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinSpecialValue1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxSpecialValue1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">(</span>
                <span class="n">minimum</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MinSpecialValue1</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                <span class="n">maximum</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MaxSpecialValue1</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">range</span>

    <span class="k">def</span> <span class="nf">get_range_special_value2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]:</span>
        <span class="nb">range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinSpecialValue2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxSpecialValue2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">(</span>
                <span class="n">minimum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MinSpecialValue2</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MaxSpecialValue2</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">range</span>

    <span class="k">def</span> <span class="nf">get_range_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]:</span>
        <span class="nb">range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MinObservationTime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxObservationTime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">RangeSummary</span><span class="p">(</span>
                <span class="n">minimum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MinObservationTime</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">maximum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MaxObservationTime</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">range</span>

    <span class="k">def</span> <span class="nf">get_summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">Summaries</span><span class="p">]:</span>
        <span class="n">summaries</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">range_orbits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_orbit</span><span class="p">()</span>
        <span class="n">range_special_value1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_special_value1</span><span class="p">()</span>
        <span class="n">range_special_value2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_special_value2</span><span class="p">()</span>
        <span class="n">range_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_range_time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">range_orbits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summaries</span><span class="p">[</span><span class="s2">&quot;orbit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">range_orbits</span>
        <span class="k">if</span> <span class="n">range_special_value1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summaries</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SpecialValue1</span><span class="p">]</span> <span class="o">=</span> <span class="n">range_special_value1</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">range_special_value2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summaries</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SpecialValue2</span><span class="p">]</span> <span class="o">=</span> <span class="n">range_special_value2</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">range_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summaries</span><span class="p">[</span><span class="s2">&quot;observation_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">range_time</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">Summaries</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">summaries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Summaries</span><span class="p">(</span><span class="n">summaries</span><span class="o">=</span><span class="n">summaries</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;ODEMetaDB&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;IHID&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;IID&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;DataSetId&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;ValidFootprints&quot;</span> <span class="ow">in</span> <span class="n">env</span> <span class="ow">and</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;ValidFootprints&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Missing `Footprints` for </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2"> IIPTSet: not added, return None.&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="s2">&quot;NumberProducts&quot;</span> <span class="ow">in</span> <span class="n">env</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;NumberProducts&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Missing `NumberProducts` for </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2"> IIPTSet: not added, return None.&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="n">parameters</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
                <span class="o">**</span><span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">UtilsMath</span><span class="o">.</span><span class="n">convert_dt</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">env</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PdsCollectionAttributeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[KeyError] - </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2"> is missing for </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PdsCollectionAttributeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[TypeError] - </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2"> is missing for </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_stac_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Collection</span><span class="p">:</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Collection</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_collection_id</span><span class="p">(),</span>
            <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">PTName</span><span class="si">}</span><span class="s2"> products&quot;</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="n">pystac</span><span class="o">.</span><span class="n">Extent</span><span class="p">(</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">SpatialExtent</span><span class="p">(</span><span class="n">bboxes</span><span class="o">=</span><span class="p">[[]]),</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">TemporalExtent</span><span class="p">(</span><span class="n">intervals</span><span class="o">=</span><span class="p">[[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]),</span>
            <span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(),</span>
            <span class="n">extra_fields</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;instruments&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_instrument</span><span class="p">()],</span>
                <span class="s2">&quot;plateform&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plateform</span><span class="p">(),</span>
                <span class="s2">&quot;mission&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mission</span><span class="p">(),</span>
            <span class="p">},</span>
            <span class="n">license</span><span class="o">=</span><span class="s2">&quot;CC0-1.0&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">summaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_summaries</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">summaries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">collection</span><span class="o">.</span><span class="n">summaries</span> <span class="o">=</span> <span class="n">summaries</span>
        <span class="k">return</span> <span class="n">collection</span>

    <span class="k">def</span> <span class="nf">create_stac_instru_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_instrument_id</span><span class="p">(),</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_instrument</span><span class="p">(),</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_stac_platform_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_plateform_id</span><span class="p">(),</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_plateform</span><span class="p">(),</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_stac_mission_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_mission_id</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_mission</span><span class="p">(),</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_stac_body_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">:</span>
        <span class="n">url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">ODEMetaDB</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
            <span class="k">case</span> <span class="s2">&quot;VENUS&quot;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://solarsystem.nasa.gov/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcTBFIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--1d5cefd65606b80f88a16ac6c3e4afde8d2e1ee6/PIA00271_detail.jpg?disposition=attachment&quot;</span>
            <span class="k">case</span> <span class="s2">&quot;MERCURY&quot;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nasa.gov/sites/default/files/mercury_1.jpg&quot;</span>
            <span class="k">case</span> <span class="s2">&quot;MARS&quot;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://mars.nasa.gov/system/site_config_values/meta_share_images/1_mars-nasa-gov.jpg&quot;</span>
            <span class="k">case</span> <span class="s2">&quot;MOON&quot;</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nasa.gov/sites/default/files/styles/full_width_feature/public/thumbnails/image/opo9914d.jpg&quot;</span>
            <span class="k">case</span> <span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PlanetNotFound</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected body to parse : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ODEMetaDB</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="n">extension</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_ssys_extension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_body</span><span class="p">())</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_body_id</span><span class="p">(),</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_body</span><span class="p">(),</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">stac_extensions</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">extra_fields</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">catalog</span><span class="o">.</span><span class="n">stac_extensions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">[</span><span class="s2">&quot;stac_extensions&quot;</span><span class="p">])</span>
        <span class="n">catalog</span><span class="o">.</span><span class="n">extra_fields</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">extension</span><span class="p">[</span><span class="s2">&quot;extra_fields&quot;</span><span class="p">])</span>
        <span class="n">catalog</span><span class="o">.</span><span class="n">add_link</span><span class="p">(</span>
            <span class="n">pystac</span><span class="o">.</span><span class="n">Link</span><span class="p">(</span>
                <span class="n">rel</span><span class="o">=</span><span class="n">pystac</span><span class="o">.</span><span class="n">RelType</span><span class="o">.</span><span class="n">PREVIEW</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">media_type</span><span class="o">=</span><span class="n">pystac</span><span class="o">.</span><span class="n">MediaType</span><span class="o">.</span><span class="n">JPEG</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ODEMetaDB</span><span class="p">,</span>
                <span class="n">extra_fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;credits&quot;</span><span class="p">:</span> <span class="s2">&quot;NASA&quot;</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">catalog</span>

<div class="viewcode-block" id="PdsRegistryModel.to_hdf5"><a class="viewcode-back" href="../../../reference_manual.html#pds_crawler.models.ode_ws_models.PdsRegistryModel.to_hdf5">[docs]</a>    <span class="k">def</span> <span class="nf">to_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store_db</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Saves the information in the attributes of a HDF5 node</span>

<span class="sd">        Args:</span>
<span class="sd">            store_db (Any): HDF5 node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pds_collection_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">pds_collection_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">pds_collection_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="c1"># when type is a dictionnary or list, a specific datatype</span>
            <span class="c1"># is needed to encode an attribute in HDF5</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">store_db</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">string_</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">store_db</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div></div>


<div class="viewcode-block" id="PdsRecordModel"><a class="viewcode-back" href="../../../reference_manual.html#pds_crawler.models.ode_ws_models.PdsRecordModel">[docs]</a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">PdsRecordModel</span><span class="p">(</span><span class="n">AbstractModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ODE meta-data.&quot;&quot;&quot;</span>

    <span class="n">ode_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;An internal ODE product identifier.</span>
<span class="sd">    NOTE: This id is assigned by ODE when the product is</span>
<span class="sd">    added to the ODE metadata database. It is</span>
<span class="sd">    generally stable but can be changed when the</span>
<span class="sd">    ODE metadatabase is rebuilt. In general, this id</span>
<span class="sd">    should only be used shortly after acquisition.&quot;&quot;&quot;</span>
    <span class="n">pdsid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;PDS Product Id&quot;&quot;&quot;</span>
    <span class="n">ihid</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Instrument host id. See ODE for valid instrument host ids&quot;&quot;&quot;</span>
    <span class="n">iid</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Instrument id. See ODE for valid instrument ids&quot;&quot;&quot;</span>
    <span class="n">pt</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;ODE Product type. This is ODE&#39;s product type.</span>
<span class="sd">    In general, it is obtained from the label but can</span>
<span class="sd">    be changed or depending on whether a label has</span>
<span class="sd">    a product type, whether there are other products</span>
<span class="sd">    in the same instrument with the same product</span>
<span class="sd">    type in the label, etc. If this is not the same</span>
<span class="sd">    product type as in the label, the return will</span>
<span class="sd">    include a Label_Product_Type value as well&quot;&quot;&quot;</span>
    <span class="n">LabelFileName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;The file name of the product label&quot;&quot;&quot;</span>
    <span class="n">Product_creation_time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Product creation time (UTC)&quot;&quot;&quot;</span>
    <span class="n">Target_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Product target (example: Mars)&quot;&quot;&quot;</span>
    <span class="n">Data_Set_Id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;PDS Data Set Id&quot;&quot;&quot;</span>
    <span class="n">Easternmost_longitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Longitude 0-360 Easternmost longitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Maximum_latitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Planetocentric maximum latitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Minimum_latitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Planetocentric minimum latitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Westernmost_longitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Longitude 0-360 Westernmost longitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Product_version_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Product version&quot;&quot;&quot;</span>
    <span class="n">RelativePathtoVol</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;The relative path from the volume root to the</span>
<span class="sd">    product label file&quot;&quot;&quot;</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Complete product label for PDS3 product labels&quot;&quot;&quot;</span>
    <span class="n">PDS4LabelURL</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Pointer to PDS4 XML label for PDS4 products&quot;&quot;&quot;</span>
    <span class="n">PDSVolume_Id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Volume Id&quot;&quot;&quot;</span>
    <span class="n">Label_product_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Label product type (if it exists in the label and is</span>
<span class="sd">    different from the ODE_Product_Type)&quot;&quot;&quot;</span>
    <span class="n">Observation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Identifies a scientific observation within a dataset.&quot;&quot;&quot;</span>
    <span class="n">Observation_number</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Monotonically increasing ordinal counter of the</span>
<span class="sd">    EDRs generated for a particular OBSERVATION_ID. &quot;&quot;&quot;</span>
    <span class="n">Observation_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Identifies the general type of an observation&quot;&quot;&quot;</span>
    <span class="n">Producer_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Producer id&quot;&quot;&quot;</span>
    <span class="n">Product_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Product name&quot;&quot;&quot;</span>
    <span class="n">Product_release_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Product release date&quot;&quot;&quot;</span>
    <span class="n">Activity_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Label Activity id&quot;&quot;&quot;</span>
    <span class="n">Predicted_dust_opacity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Predicted dust opacity&quot;&quot;&quot;</span>
    <span class="n">Predicted_dust_opacity_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Predicted dust opacity text.&quot;&quot;&quot;</span>
    <span class="n">Observation_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Observation time (mid-point between the start</span>
<span class="sd">    and end of the observation)&quot;&quot;&quot;</span>
    <span class="n">SpaceCraft_clock_start_count</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Spacecraft clock start&quot;&quot;&quot;</span>
    <span class="n">SpaceCraft_clock_stop_count</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Spacecraft clock end&quot;&quot;&quot;</span>
    <span class="n">Start_orbit_number</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Start orbit number&quot;&quot;&quot;</span>
    <span class="n">Stop_orbit_number</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;End orbit number&quot;&quot;&quot;</span>
    <span class="n">UTC_start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Observation start time in UTC&quot;&quot;&quot;</span>
    <span class="n">UTC_stop_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Observation end time in UTC&quot;&quot;&quot;</span>
    <span class="n">Emission_angle</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Emission angle&quot;&quot;&quot;</span>
    <span class="n">Emission_angle_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Emission angle text from the product label&quot;&quot;&quot;</span>
    <span class="n">Phase_angle</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Phase angle&quot;&quot;&quot;</span>
    <span class="n">Phase_angle_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Phase angle text from the product label&quot;&quot;&quot;</span>
    <span class="n">Incidence_angle</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Incidence angle&quot;&quot;&quot;</span>
    <span class="n">Incidence_angle_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Incidence angle text from the product label&quot;&quot;&quot;</span>
    <span class="n">Map_resolution</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Map resolution&quot;&quot;&quot;</span>
    <span class="n">Map_resolution_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Map resolution text from the product label&quot;&quot;&quot;</span>
    <span class="n">Map_scale</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Map scale&quot;&quot;&quot;</span>
    <span class="n">Map_scale_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Map scale text from the product label&quot;&quot;&quot;</span>
    <span class="n">Solar_distance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Solar distance&quot;&quot;&quot;</span>
    <span class="n">Solar_distance_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Solar distance text from the product label&quot;&quot;&quot;</span>
    <span class="n">Solar_longitude</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Solar longitude&quot;&quot;&quot;</span>
    <span class="n">Center_georeferenced</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;T if the product has a footprint center&quot;&quot;&quot;</span>
    <span class="n">Center_latitude</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Planetocentric footprint center latitude&quot;&quot;&quot;</span>
    <span class="n">Center_longitude</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Longitude 0-360 center longitude&quot;&quot;&quot;</span>
    <span class="n">Center_latitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Text found in the center latitude label keyword</span>
<span class="sd">    if the center latitude is not a valid number&quot;&quot;&quot;</span>
    <span class="n">Center_longitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Text found in the center longitude label keyword</span>
<span class="sd">    if the center longitude is not a valid number&quot;&quot;&quot;</span>
    <span class="n">BB_georeferenced</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;T if the product has a footprint bounding box&quot;&quot;&quot;</span>
    <span class="n">Easternmost_longitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Longitude 0-360 Easternmost longitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Maximum_latitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Planetocentric maximum latitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Minimum_latitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Planetocentric minimum latitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Westernmost_longitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Longitude 0-360 Westernmost longitude of the footprint&quot;&quot;&quot;</span>
    <span class="n">Easternmost_longitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Text found in the easternmost longitude label</span>
<span class="sd">    keyword if the easternmost longitude is not a</span>
<span class="sd">    valid number&quot;&quot;&quot;</span>
    <span class="n">Maximum_latitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Text found in the maximum latitude label</span>
<span class="sd">    keyword if the maximum latitude is not a valid</span>
<span class="sd">    number&quot;&quot;&quot;</span>
    <span class="n">Minimum_latitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Text found in the minimum latitude label</span>
<span class="sd">    keyword if the minimum latitude is not a valid</span>
<span class="sd">    number&quot;&quot;&quot;</span>
    <span class="n">Westernmost_longitude_text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Text found in the westernmost longitude label</span>
<span class="sd">    keyword if the westernmost longitude is not a</span>
<span class="sd">    valid number&quot;&quot;&quot;</span>
    <span class="n">Footprint_geometry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Cylindrical projected planetocentric, longitude</span>
<span class="sd">    0-360 product footprint in WKT format. Only if</span>
<span class="sd">    there is a valid footprint. Note - this is a</span>
<span class="sd">    cylindrical projected footprint. The footprint has</span>
<span class="sd">    been split into multiple polygons when crossing</span>
<span class="sd">    the 0/360 longitude line and any footprints that</span>
<span class="sd">    cross the poles have been adjusted to add points</span>
<span class="sd">    to and around the pole. It is meant for use in</span>
<span class="sd">    cylindrical projects and is not appropriate for</span>
<span class="sd">    spherical displays.&quot;&quot;&quot;</span>
    <span class="n">Footprint_C0_geometry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Planetocentric, longitude -180-180 product</span>
<span class="sd">    footprint in WKT format. Only if there is a valid</span>
<span class="sd">    footprint. Note - this is a cylindrical projected</span>
<span class="sd">    footprint. The footprint has been split into</span>
<span class="sd">    multiple polygons when crossing the -180/180</span>
<span class="sd">    longitude line and any footprints that cross the</span>
<span class="sd">    poles have been adjusted to add points to and</span>
<span class="sd">    around the pole. It is meant for use in cylindrical</span>
<span class="sd">    projects and is not appropriate for spherical</span>
<span class="sd">    displays.&quot;&quot;&quot;</span>
    <span class="n">Footprint_GL_geometry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Planetocentric, longitude 0-360 product</span>
<span class="sd">    footprint in WKT format. Only if there is a valid</span>
<span class="sd">    footprint. This is not a projected footprint.&quot;&quot;&quot;</span>
    <span class="n">Footprint_NP_geometry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Stereographic south polar projected footprint in</span>
<span class="sd">    WKT format. Only if there is a valid footprint.</span>
<span class="sd">    This footprint has been projected into meters in</span>
<span class="sd">    stereographic north polar projection&quot;&quot;&quot;</span>
    <span class="n">Footprint_SP_geometry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Stereographic south polar projected footprint in</span>
<span class="sd">    WKT format. Only if there is a valid footprint.</span>
<span class="sd">    This footprint has been projected into meters in</span>
<span class="sd">    stereographic south polar projection.&quot;&quot;&quot;</span>
    <span class="n">Footprints_cross_meridian</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;T if the footprint crosses the 0/360 longitude line&quot;&quot;&quot;</span>
    <span class="n">Pole_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;String of &quot;none&quot;, &quot;north&quot;, or &quot;south&quot;&quot;&quot;</span>
    <span class="n">Footprint_souce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;A brief description of where the footprint came from&quot;&quot;&quot;</span>
    <span class="n">USGS_Sites</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;A USGS site that this product&#39;s footprint partially or completely covers&quot;&quot;&quot;</span>
    <span class="n">Comment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Any associated comment&quot;&quot;&quot;</span>
    <span class="n">Description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Label description&quot;&quot;&quot;</span>
    <span class="n">ODE_notes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;A note about how data has been entered into ODE&quot;&quot;&quot;</span>
    <span class="n">External_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;URL to an external reference to the product.</span>
<span class="sd">    Product type specific but usually something like</span>
<span class="sd">    the HiRISE site.&quot;&quot;&quot;</span>
    <span class="n">External_url2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;URL to an external reference to the product.</span>
<span class="sd">    Product type specific but usually something like</span>
<span class="sd">    the HiRISE site.&quot;&quot;&quot;</span>
    <span class="n">External_url3</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;URL to an external reference to the product.</span>
<span class="sd">    Product type specific but usually something like</span>
<span class="sd">    the HiRISE site&quot;&quot;&quot;</span>
    <span class="n">FilesURL</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ProductURL</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">LabelURL</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Product_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ProductFile</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">browse</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;If there is an ODE browse image - returns a base64 string of the PNG image&quot;&quot;&quot;</span>
    <span class="n">thumbnail</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;If there is an ODE thumbnail image - returns a base64 string of the PNG image&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ode_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdsid</span>

    <span class="k">def</span> <span class="nf">get_description</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Description</span>

    <span class="k">def</span> <span class="nf">get_collection_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_collection_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_collection</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Data_Set_Id</span>

    <span class="k">def</span> <span class="nf">get_instrument_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_instru_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pds_registry_model</span><span class="p">:</span> <span class="n">PdsRegistryModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pds_registry_model</span><span class="o">.</span><span class="n">IName</span>

    <span class="k">def</span> <span class="nf">get_plateform_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_platform_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ihid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_plateform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pds_registry_model</span><span class="p">:</span> <span class="n">PdsRegistryModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pds_registry_model</span><span class="o">.</span><span class="n">IHName</span>

    <span class="k">def</span> <span class="nf">get_mission_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_mission_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mission</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_mission</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ihid</span>

    <span class="k">def</span> <span class="nf">get_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Target_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Target_name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">body</span>

    <span class="k">def</span> <span class="nf">get_body_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">create_body_id</span><span class="p">(</span><span class="n">Labo</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_body</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_start_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">start_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC_start_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span>
                    <span class="n">utc_to_iso</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC_start_time</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
                <span class="n">start_date</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">start_date</span>

    <span class="k">def</span> <span class="nf">get_stop_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">stop_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC_stop_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">stop_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span>
                    <span class="n">utc_to_iso</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC_stop_time</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
                <span class="n">stop_date</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">stop_date</span>

    <span class="k">def</span> <span class="nf">get_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">geometry</span><span class="o">.</span><span class="n">mapping</span><span class="p">(</span><span class="n">wkt</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Footprint_C0_geometry</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Westernmost_longitude</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Minimum_latitude</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Easternmost_longitude</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Maximum_latitude</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_gsd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Map_resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Map_resolution</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="n">date_obs</span><span class="p">:</span> <span class="nb">str</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observation_time</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observation_time</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
            <span class="s2">&quot;0000&quot;</span>
        <span class="p">):</span>
            <span class="n">date_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observation_time</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Product_creation_time</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Product_creation_time</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;0000&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">date_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Product_creation_time</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot find </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Observation_time</span><span class="si">}</span><span class="s2">, use Product_creation_time as datetime for </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">Product_release_date</span><span class="p">:</span>
            <span class="n">date_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Product_release_date</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot find </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Observation_time</span><span class="si">}</span><span class="s2">, use Product_creation_time as datetime for </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No datetime&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">utc_to_iso</span><span class="p">(</span><span class="n">date_obs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span>
            <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;pt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;LabelFileName&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Product_creation_time&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Product_version_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PDS4LabelURL&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Data_Set_Id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PDSVolume_Id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Label_product_type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Observation_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Observation_number&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Observation_type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Producer_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Product_name&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Product_release_date&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Activity_id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Predicted_dust_opacity&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Predicted_dust_opacity_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Observation_time&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SpaceCraft_clock_start_count&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SpaceCraft_clock_stop_count&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Start_orbit_number&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Stop_orbit_number&quot;</span><span class="p">,</span>
                <span class="s2">&quot;UTC_start_time&quot;</span><span class="p">,</span>
                <span class="s2">&quot;UTC_stop_time&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Emission_angle&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Emission_angle_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Phase_angle&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Phase_angle_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Incidence_angle&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Incidence_angle_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Map_resolution_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Map_scale&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Map_scale_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Solar_distance&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Solar_distance_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Solar_longitude&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Center_latitude&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Center_longitude&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Center_latitude_text&quot;</span><span class="p">,</span>
                <span class="s2">&quot;USGS_Sites&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Comment&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">}</span>
        <span class="n">season</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">PdsspModel</span><span class="o">.</span><span class="n">add_mars_keywords_if_mars</span><span class="p">(</span>
            <span class="n">body_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_body</span><span class="p">(),</span>
            <span class="n">ode_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ode_id</span><span class="p">,</span>
            <span class="n">lat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Center_latitude</span><span class="p">,</span>
            <span class="n">slong</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Solar_longitude</span><span class="p">,</span>
            <span class="n">date</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_datetime</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">properties</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">properties</span>

    <span class="k">def</span> <span class="nf">set_common_metadata</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">,</span> <span class="n">pds_registry</span><span class="p">:</span> <span class="n">PdsRegistryModel</span>
    <span class="p">):</span>
        <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">license</span> <span class="o">=</span> <span class="s2">&quot;CC0-1.0&quot;</span>
        <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">instruments</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_instrument</span><span class="p">(</span><span class="n">pds_registry</span><span class="p">)]</span>
        <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">platform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plateform</span><span class="p">(</span><span class="n">pds_registry</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">mission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mission</span><span class="p">()</span>
        <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_description</span><span class="p">()</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_start_date</span><span class="p">()</span>
        <span class="n">stop_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stop_date</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">start_datetime</span> <span class="o">=</span> <span class="n">start_date</span>
        <span class="k">if</span> <span class="n">stop_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">end_datetime</span> <span class="o">=</span> <span class="n">stop_date</span>
        <span class="n">gsd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gsd</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">gsd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">common_metadata</span><span class="o">.</span><span class="n">gsd</span> <span class="o">=</span> <span class="n">gsd</span>

    <span class="k">def</span> <span class="nf">add_assets_product_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Product_files</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">product_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Product_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">product_file</span><span class="o">.</span><span class="n">URL</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">product_file</span><span class="o">.</span><span class="n">FileName</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="n">product_file</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">product_file</span><span class="o">.</span><span class="n">FileName</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">product_file</span><span class="o">.</span><span class="n">Description</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_assets_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">browse</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Browse image&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;overview&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_assets_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Thumbnail image&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;thumbnail&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_assets_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LabelURL</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LabelURL</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LabelURL</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Browse Label&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ProductURL</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ProductURL</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProductURL</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Product URL&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FilesURL</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FilesURL</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">FilesURL</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Files URL&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_assets_external_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">External_url</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">External_url</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">External_url</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;External URL&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">External_url2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">External_url2</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">External_url2</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;External URL2&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">External_url3</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">External_url3</span><span class="p">)</span>
            <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">add_asset</span><span class="p">(</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">pystac</span><span class="o">.</span><span class="n">Asset</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">External_url3</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;External URL3&quot;</span><span class="p">,</span>
                    <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_ssys_extention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
        <span class="n">item</span><span class="o">.</span><span class="n">stac_extensions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;https://raw.githubusercontent.com/thareUSGS/ssys/main/json-schema/schema.json&quot;</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ssys:targets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Target_name</span><span class="p">]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;ssys:targets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Target_name</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;Footprint_geometry&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">env</span><span class="p">:</span>
                <span class="c1"># logger.warning(f&#39;Missing data = records.get_sample_records_pds(col.ODEMetaDB,col.IHID,col.IID,col.PT, col.NumberProducts, limit=1)`Footprint_geometry` for IIPTSet: not added, return None.&#39;)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;Product_files&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Product_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">ProductFile</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Product_files&quot;</span><span class="p">][</span><span class="s2">&quot;Product_file&quot;</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
                <span class="o">**</span><span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">UtilsMath</span><span class="o">.</span><span class="n">convert_dt</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parameters</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
            <span class="n">collection_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;Target_name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;ihid&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;iid&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="s2">&quot;Data_Set_Id&quot;</span> <span class="ow">in</span> <span class="n">env</span><span class="p">:</span>
                <span class="n">collection_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;Data_Set_Id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="n">PdsRecordAttributeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[KeyError] - </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2"> is missing for </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
            <span class="n">collection_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;Target_name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;ihid&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;iid&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="s2">&quot;Data_Set_Id&quot;</span> <span class="ow">in</span> <span class="n">env</span><span class="p">:</span>
                <span class="n">collection_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;Data_Set_Id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="n">PdsRecordAttributeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[TypeError] - </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2"> is missing for </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_stac_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pds_registry</span><span class="p">:</span> <span class="n">PdsRegistryModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span>
                <span class="n">geometry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">(),</span>
                <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">(),</span>
                <span class="n">datetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_datetime</span><span class="p">(),</span>
                <span class="n">properties</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_properties</span><span class="p">(),</span>
                <span class="n">collection</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_collection_id</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_common_metadata</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">pds_registry</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_assets_product_types</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_assets_browse</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_assets_thumbnail</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_assets_data</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_assets_external_files</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_ssys_extention</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">item</span>
        <span class="k">except</span> <span class="n">PdsCollectionAttributeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CrawlerError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            error : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            Message : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">__cause__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            class: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            data: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">PdsRecordAttributeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CrawlerError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            error : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            Message : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">__cause__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            class: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            data: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">PlanetNotFound</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CrawlerError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            error : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            Message : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">__cause__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            class: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            data: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">DateConversionError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CrawlerError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            error : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            Message : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">__cause__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            class: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            data: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected error : </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CrawlerError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Unexpected error : </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">__cause__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            class: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            data: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="PdsRecordsModel"><a class="viewcode-back" href="../../../reference_manual.html#pds_crawler.models.ode_ws_models.PdsRecordsModel">[docs]</a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">PdsRecordsModel</span><span class="p">(</span><span class="n">AbstractModel</span><span class="p">):</span>
    <span class="n">pds_records_model</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PdsRecordModel</span><span class="p">]</span>
    <span class="n">target_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">plateform_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">instrument_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PdsRecordsModel&quot;</span><span class="p">]:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PdsRecordsModel</span><span class="p">]</span>
        <span class="n">pds_records_model</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">env</span><span class="p">:</span>
            <span class="n">pds_record_model</span><span class="p">:</span> <span class="n">PdsRecordModel</span> <span class="o">=</span> <span class="n">PdsRecordModel</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pds_record_model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pds_records_model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pds_record_model</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pds_records_model</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">PdsRecordsModel</span><span class="p">(</span>
                <span class="n">pds_records_model</span><span class="o">=</span><span class="n">pds_records_model</span><span class="p">,</span>
                <span class="n">target_name</span><span class="o">=</span><span class="n">pds_records_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Target_name</span><span class="p">,</span>
                <span class="n">plateform_id</span><span class="o">=</span><span class="n">pds_records_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ihid</span><span class="p">,</span>
                <span class="n">instrument_id</span><span class="o">=</span><span class="n">pds_records_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iid</span><span class="p">,</span>
                <span class="n">dataset_id</span><span class="o">=</span><span class="n">pds_records_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Data_Set_Id</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">to_stac_item_iter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">pds_registry</span><span class="p">:</span> <span class="n">PdsRegistryModel</span><span class="p">,</span> <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">pystac</span><span class="o">.</span><span class="n">Item</span><span class="p">]:</span>
        <span class="n">pds_records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pds_records_model</span>
        <span class="k">with</span> <span class="n">ProgressLogger</span><span class="p">(</span>
            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pds_records</span><span class="p">),</span>
            <span class="n">iterable</span><span class="o">=</span><span class="n">pds_records</span><span class="p">,</span>
            <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Downloaded responses from the collection&quot;</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">disable_tqdm</span><span class="o">=</span><span class="ow">not</span> <span class="n">progress_bar</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">progress_logger</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pds_record_model</span> <span class="ow">in</span> <span class="n">progress_logger</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">cast</span><span class="p">(</span><span class="n">PdsRecordModel</span><span class="p">,</span> <span class="n">pds_record_model</span><span class="p">)</span><span class="o">.</span><span class="n">to_stac_item</span><span class="p">(</span>
                    <span class="n">pds_registry</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;PdsRecordsModel(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plateform_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_id</span><span class="si">}</span><span class="s2">, nb_records=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pds_records_model</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span></div>
</pre></div>

    </div>
      
  </div>
</div>
  <!--<h2>My footer of awesomeness.</h2>-->
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023 - CNES (Jean-Christophe Malapert for Pôle Surfaces Planétaires).<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.1.<br/>
    </p>
  </div>
</footer>

  </body>
</html>